import{t as e}from"./ogqc9zYh.js";import{t}from"./3ipVC6po.js";import"./Bev_IC9g.js";import{t as n}from"./wBPek5fi.js";import{r,t as i}from"./DNAsxgPe.js";import{t as a}from"./CadwJUqi.js";import{Cn as o,Dn as s,Dr as c,Dt as l,E as u,En as d,Et as f,Fr as p,Kn as m,Mn as h,Mr as g,Ot as _,Pn as v,Pr as y,Rr as b,Tn as x,U as S,Wt as C,Xn as w,_n as T,_r as E,ar as D,er as O,et as k,f as A,fr as j,ft as M,gn as N,m as P,nr as F,qn as I,rr as L,ur as R,ut as z,wn as B,yn as V}from"#entry";import{t as H}from"./DH4oaEtg.js";function U(t,n){let r=c(),i=(e,i)=>{if(n.multiple&&Array.isArray(t.value))if(n.selectionBehavior===`replace`)t.value=[e],r.value=e;else{let n=t.value.findIndex(e=>i(e));n===-1?t.value=[...t.value,e]:t.value=t.value.filter((e,t)=>t!==n)}else n.selectionBehavior===`replace`?t.value={...e}:!Array.isArray(t.value)&&i(t.value)?t.value=void 0:t.value={...e};return t.value};function a(i,a,o,s){if(!r?.value||!n.multiple||!Array.isArray(t.value))return;let c=o().filter(e=>e.ref.dataset.disabled!==``).find(e=>e.ref===a)?.value;if(!c)return;let l=null;switch(i){case`prev`:case`next`:l=e(s,r.value,c);break;case`first`:l=e(s,r.value,s?.[0]);break;case`last`:l=e(s,r.value,s?.[s.length-1]);break}t.value=l}return{firstValue:r,onSelectItem:i,handleMultipleReplace:a}}function W(e){return e.reduce((e,t)=>(e.push(t),t.children&&e.push(...W(t.children)),e),[])}var[G,K]=_(`TreeRoot`),q=v({__name:`TreeRoot`,props:{modelValue:{type:null,required:!1},defaultValue:{type:null,required:!1},items:{type:Array,required:!1},expanded:{type:Array,required:!1},defaultExpanded:{type:Array,required:!1},getKey:{type:Function,required:!0},getChildren:{type:Function,required:!1,default:e=>e.children},selectionBehavior:{type:String,required:!1,default:`toggle`},multiple:{type:Boolean,required:!1,skipCheck:!0},dir:{type:String,required:!1},disabled:{type:Boolean,required:!1},propagateSelect:{type:Boolean,required:!1},bubbleSelect:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:`ul`}},emits:[`update:modelValue`,`update:expanded`],setup(e,{emit:a}){let s=e,u=a,{items:d,multiple:f,disabled:p,propagateSelect:m,dir:_,bubbleSelect:v}=g(s),{handleTypeaheadSearch:b}=n(),S=t(_),C=c(),w=c(!1),D=M(),A=z(s,`modelValue`,u,{defaultValue:s.defaultValue??(f.value?[]:void 0),passive:!0,deep:!0}),j=z(s,`expanded`,u,{defaultValue:s.defaultExpanded??[],passive:s.expanded===void 0,deep:!0}),{onSelectItem:P,handleMultipleReplace:F}=U(A,s),R=o(()=>f.value&&Array.isArray(A.value)?A.value.map(e=>s.getKey(e)):[s.getKey(A.value??{})]);function B(e,t=1,n){return e.reduce((r,i,a)=>{let o=s.getKey(i),c=s.getChildren(i),l=j.value.includes(o),u={_id:o,value:i,index:a,level:t,parentItem:n,hasChildren:!!c,bind:{value:i,level:t,"aria-setsize":e.length,"aria-posinset":a+1}};return r.push(u),c&&l&&r.push(...B(c,t+1,i)),r},[])}let V=o(()=>{let e=s.items;return j.value.map(e=>e),B(e??[])});function H(e){if(w.value)D.trigger(e);else{let t=C.value?.getItems()??[];b(e.key,t)}}function G(e){if(w.value)return;let t=r[e.key];I(()=>{F(t,l(),C.value?.getItems,V.value.map(e=>e.value))})}function q(e){if(e.parentItem!=null&&Array.isArray(A.value)&&s.multiple){let t=V.value.find(t=>e.parentItem!=null&&s.getKey(t.value)===s.getKey(e.parentItem));t!=null&&(s.getChildren(t.value)?.every(e=>A.value.find(t=>s.getKey(t)===s.getKey(e)))?A.value=[...A.value,t.value]:A.value=A.value.filter(e=>s.getKey(e)!==s.getKey(t.value)),q(t))}}return K({modelValue:A,selectedKeys:R,onSelect:e=>{let t=t=>s.getKey(t??{})===s.getKey(e),n=s.multiple&&Array.isArray(A.value)?A.value?.findIndex(t)!==-1:void 0;if(P(e,t),s.bubbleSelect&&s.multiple&&Array.isArray(A.value)){let t=V.value.find(t=>s.getKey(t.value)===s.getKey(e));t!=null&&q(t)}if(s.propagateSelect&&s.multiple&&Array.isArray(A.value)){let t=W(s.getChildren(e)??[]);n?A.value=[...A.value].filter(e=>!t.some(t=>s.getKey(e??{})===s.getKey(t))):A.value=[...A.value,...t]}},expanded:j,onToggle(e){if(!(e&&s.getChildren(e)))return;let t=s.getKey(e)??e;j.value.includes(t)?j.value=j.value.filter(e=>e!==t):j.value.push(t)},getKey:s.getKey,getChildren:s.getChildren,items:d,expandedItems:V,disabled:p,multiple:f,dir:S,propagateSelect:m,bubbleSelect:v,isVirtual:w,virtualKeydownHook:D,handleMultipleReplace:F}),(e,t)=>(O(),x(y(i),{ref_key:`rovingFocusGroupRef`,ref:C,"as-child":``,orientation:`vertical`,dir:y(S)},{default:E(()=>[h(y(k),{role:`tree`,as:e.as,"as-child":e.asChild,"aria-multiselectable":y(f)?!0:void 0,onKeydown:[H,N(T(G,[`shift`]),[`up`,`down`])]},{default:E(()=>[L(e.$slots,`default`,{flattenItems:V.value,modelValue:y(A),expanded:y(j)})]),_:3},8,[`as`,`as-child`,`aria-multiselectable`,`onKeydown`])]),_:3},8,[`dir`]))}}),J=`tree.select`,Y=`tree.toggle`,X=v({inheritAttrs:!1,__name:`TreeItem`,props:{value:{type:null,required:!0},level:{type:Number,required:!0},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:`li`}},emits:[`select`,`toggle`],setup(e,{expose:t,emit:n}){let r=e,i=n,s=G(),{getItems:c}=S(),u=o(()=>!!s.getChildren(r.value)),d=o(()=>{let e=s.getKey(r.value);return s.expanded.value.includes(e)}),p=o(()=>{let e=s.getKey(r.value);return s.selectedKeys.value.includes(e)}),g=o(()=>{if(s.bubbleSelect.value&&u.value&&Array.isArray(s.modelValue.value)){let e=W(s.getChildren(r.value)||[]);return e.some(e=>s.modelValue.value.find(t=>s.getKey(t)===s.getKey(e)))&&!e.every(e=>s.modelValue.value.find(t=>s.getKey(t)===s.getKey(e)))}else if(s.propagateSelect.value&&p.value&&u.value&&Array.isArray(s.modelValue.value))return!W(s.getChildren(r.value)||[]).every(e=>s.modelValue.value.find(t=>s.getKey(t)===s.getKey(e)));else return});function _(e){if(u.value)if(d.value){let e=c().map(e=>e.ref),t=l(),n=e.indexOf(t),i=[...e].slice(n).find(e=>Number(e.getAttribute(`data-indent`))===r.level+1);i&&i.focus()}else D(e)}function v(e){if(d.value)D(e);else{let e=c().map(e=>e.ref),t=l(),n=e.indexOf(t),i=[...e].slice(0,n).reverse().find(e=>Number(e.getAttribute(`data-indent`))===r.level-1);i&&i.focus()}}async function b(e){i(`select`,e),!e?.defaultPrevented&&s.onSelect(r.value)}async function C(e){i(`toggle`,e),!e?.defaultPrevented&&s.onToggle(r.value)}async function w(e){e&&f(J,b,{originalEvent:e,value:r.value,isExpanded:d.value,isSelected:p.value})}async function D(e){e&&f(Y,C,{originalEvent:e,value:r.value,isExpanded:d.value,isSelected:p.value})}return t({isExpanded:d,isSelected:p,isIndeterminate:g,handleToggle:()=>s.onToggle(r.value),handleSelect:()=>s.onSelect(r.value)}),(e,t)=>(O(),x(y(a),{"as-child":``,value:e.value,"allow-shift-key":``},{default:E(()=>[h(y(k),m(e.$attrs,{role:`treeitem`,as:e.as,"as-child":e.asChild,"aria-selected":p.value,"aria-expanded":u.value?d.value:void 0,"aria-level":e.level,"data-indent":e.level,"data-selected":p.value?``:void 0,"data-expanded":d.value?``:void 0,onKeydown:[N(T(w,[`self`,`prevent`]),[`enter`,`space`]),t[0]||=N(T(e=>y(s).dir.value===`ltr`?_(e):v(e),[`prevent`]),[`right`]),t[1]||=N(T(e=>y(s).dir.value===`ltr`?v(e):_(e),[`prevent`]),[`left`])],onClick:t[2]||=T(e=>{w(e),D(e)},[`stop`])}),{default:E(()=>[L(e.$slots,`default`,{isExpanded:d.value,isSelected:p.value,isIndeterminate:g.value,handleSelect:()=>y(s).onSelect(e.value),handleToggle:()=>y(s).onToggle(e.value)})]),_:3},16,[`as`,`as-child`,`aria-selected`,`aria-expanded`,`aria-level`,`data-indent`,`data-selected`,`data-expanded`,`onKeydown`])]),_:3},8,[`value`]))}}),Z={slots:{root:`relative lg:h-[450px] my-5 grid lg:grid-cols-3 border border-muted rounded-md`,list:`isolate relative p-2 border-b lg:border-b-0 lg:border-e border-muted overflow-y-auto`,item:``,listWithChildren:`ms-4.5 border-s border-default`,itemWithChildren:`ps-1.5 -ms-px`,link:`relative group peer w-full px-2.5 py-1.5 before:inset-y-px before:inset-x-0 flex items-center gap-1.5 text-sm before:absolute before:z-[-1] before:rounded-md focus:outline-none focus-visible:outline-none focus-visible:before:ring-inset focus-visible:before:ring-2`,linkLeadingIcon:`size-4 shrink-0`,linkLabel:`truncate`,linkTrailing:`ms-auto inline-flex gap-1.5 items-center`,linkTrailingIcon:`size-5 transform transition-transform duration-200 shrink-0 group-data-[expanded=true]:rotate-180`,content:`overflow-hidden lg:col-span-2 flex flex-col [&>div]:my-0 [&>div]:flex-1 [&>div]:flex [&>div]:flex-col [&>div>div]:border-0 [&>div>pre]:border-b-0 [&>div>pre]:border-s-0 [&>div>pre]:border-e-0 [&>div>pre]:rounded-l-none [&>div>pre]:flex-1 [&>div]:overflow-y-auto`},variants:{active:{true:{link:`text-highlighted before:bg-elevated`},false:{link:[`hover:text-highlighted hover:before:bg-elevated/50`,`transition-colors before:transition-colors`]}}}},Q=[`data-expanded`],$=Object.assign({inheritAttrs:!1},{__name:`ProseCodeTree`,props:{defaultValue:{type:String,required:!1},expandAll:{type:Boolean,required:!1},class:{type:null,required:!1},ui:{type:null,required:!1}},setup(e){let t=e,n=R(),r=C(),[i,a]=u(),l=o(()=>P({extend:P(Z),...r.ui?.prose?.codeTree||{}})()),f=c(t.defaultValue?{path:t.defaultValue}:void 0),g=c(),_=c(1),v=o(()=>(_.value,n.default?.()?.flatMap(k).filter(Boolean)||[])),S=o(()=>T(v.value));function T(e){let t=new Map,n=[];e.forEach(e=>{let r=e.label.split(`/`),i=``;r.forEach((e,a)=>{if(i=i?`${i}/${e}`:e,!t.has(i)){let o={label:e,path:i,...a<r.length-1&&{children:[]}};t.set(i,o),a===0?n.push(o):t.get(r.slice(0,a).join(`/`))?.children?.push(o)}})});let r=e=>e.sort((e,t)=>!!e.children==!!t.children?e.label.localeCompare(t.label):t.children?1:-1).map(e=>({...e,children:e.children&&r(e.children)}));return r(n)}function k(e,t){return typeof e.type==`symbol`?e.children?.map(k):{label:e.props?.filename||e.props?.label||`${t}`,icon:e.props?.icon,component:e}}let M=o(()=>{if(t.expandAll){let e=new Set;return v.value.forEach(t=>{let n=t.label.split(`/`);for(let t=1;t<n.length;t++)e.add(n.slice(0,t).join(`/`))}),Array.from(e)}let e=f.value?.path;if(!e)return[];let n=e.split(`/`);return n.map((e,t)=>n.slice(0,t+1).join(`/`))});return j(f,e=>{let t=v.value.find(t=>e?.path===t.label);t?.component&&(g.value=t)},{immediate:!0}),w(()=>_.value++),(e,n)=>(O(),s(V,null,[h(y(i),null,{default:E(({items:e,level:n})=>[(O(!0),s(V,null,F(e,(e,i)=>(O(),x(y(X),{key:`${n}-${i}`,level:n,value:e,class:p(n>1?l.value.itemWithChildren({class:t.ui?.itemWithChildren}):l.value.item({class:t.ui?.item}))},{default:E(({isExpanded:i,isSelected:o})=>[B(`button`,{type:`button`,"data-expanded":i,class:p(l.value.link({class:t.ui?.link,active:o}))},[e.children?.length?(O(),x(A,{key:0,name:i?y(r).ui.icons.folderOpen:y(r).ui.icons.folder,class:p(l.value.linkLeadingIcon({class:t.ui?.linkLeadingIcon}))},null,8,[`name`,`class`])):(O(),x(H,{key:1,filename:e.label,class:p(l.value.linkLeadingIcon({class:t.ui?.linkLeadingIcon}))},null,8,[`filename`,`class`])),B(`span`,{class:p(l.value.linkLabel({class:t.ui?.linkLabel}))},b(e.label),3),e.children?.length?(O(),s(`span`,{key:2,class:p(l.value.linkTrailing({class:t.ui?.linkTrailing}))},[h(A,{name:y(r).ui.icons.chevronDown,class:p(l.value.linkTrailingIcon({class:t.ui?.linkTrailingIcon}))},null,8,[`name`,`class`])],2)):d(``,!0)],10,Q),e.children?.length&&i?(O(),s(`ul`,{key:0,role:`group`,class:p(l.value.listWithChildren({class:t.ui?.listWithChildren}))},[h(y(a),{items:e.children,level:n+1},null,8,[`items`,`level`])],2)):d(``,!0)]),_:2},1032,[`level`,`value`,`class`]))),128))]),_:1}),B(`div`,m(e.$attrs,{class:l.value.root({class:[t.ui?.root,t.class]})}),[h(y(q),{modelValue:f.value,"onUpdate:modelValue":n[0]||=e=>f.value=e,class:p(l.value.list({class:t.ui?.list})),items:S.value,"get-key":e=>e.path,"default-expanded":M.value},{default:E(()=>[h(y(a),{items:S.value,level:1},null,8,[`items`])]),_:1},8,[`modelValue`,`class`,`items`,`get-key`,`default-expanded`]),B(`div`,{class:p(l.value.content({class:t.ui?.content}))},[(O(),x(D(g.value?.component)))],2)],16)],64))}});export{$ as default};